# Isaac Gym PPOé…ç½®æ–‡ä»¶
# UR10e RL-PIDæ··åˆæ§åˆ¶ - Isaac Gymç‰ˆæœ¬ï¼ˆæ¸…ç†é‡å¤å‚æ•°ï¼‰

# ç¯å¢ƒé…ç½®
env:
  num_envs: 2                    # å¹¶è¡Œç¯å¢ƒæ•°é‡
  max_steps: 300                # æœ€å¤§æ­¥æ•° (ä¸MuJoCoåŸå§‹é…ç½®ä¸€è‡´)
  device_id: 2                   # GPUè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  dt: 0.01                       # 100Hzï¼Œä¸MuJoCoåŸå§‹é…ç½®ä¸€è‡´

  # ç›®æ ‡ä½ç½®èŒƒå›´ (UR10eå·¥ä½œç©ºé—´)
  target_range:
    x: [-0.8, 0.8]               # Xè½´èŒƒå›´
    y: [-0.8, 0.8]               # Yè½´èŒƒå›´
    z: [0.2, 1.2]                # Zè½´èŒƒå›´

# ğŸ¯ è®¾å¤‡é…ç½®ï¼ˆå‚è€ƒisaac_gym_manipulatoræ–¹æ¡ˆï¼‰
device: "cuda:2"                 # PyTorchè®¾å¤‡ (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
sim:
  device_id: 2                   # Isaac Gymä»¿çœŸè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  # ç‰©ç†å¼•æ“é…ç½®ï¼ˆåŸºäºisaac_gym_manipulatoræˆåŠŸé…ç½®ï¼‰
  solver_type: 1                 # ä½¿ç”¨solver_type=1
  num_position_iterations: 4     # ä½ç½®è¿­ä»£æ¬¡æ•°
  num_velocity_iterations: 1     # é€Ÿåº¦è¿­ä»£æ¬¡æ•°
  num_threads: 0                 # çº¿ç¨‹æ•°ï¼ˆ0=è‡ªåŠ¨ï¼‰
  use_gpu: true                  # å¯ç”¨GPU
  use_gpu_pipeline: false        # ç¦ç”¨GPUæ¸²æŸ“ç®¡çº¿

  # æ—¶é—´æ­¥é•¿é…ç½®
  substeps: 2                    # ä½¿ç”¨2ä¸ªå­æ­¥éª¤ï¼Œæé«˜ä»¿çœŸç¨³å®šæ€§

graphics:
  graphics_device_id: 2          # å›¾å½¢è®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)

visualization:
  enable: false                   # å¯ç”¨å¯è§†åŒ–ï¼ˆå‚è€ƒisaac_gym_manipulatorï¼‰
  render_freq: 1                 # æ¸²æŸ“é¢‘ç‡

# PPOç®—æ³•é…ç½®
ppo:
  # å­¦ä¹ ç‡
  lr_actor: 3e-4                 # Actorå­¦ä¹ ç‡
  lr_critic: 1e-3                # Criticå­¦ä¹ ç‡

  # PPOæ ¸å¿ƒå‚æ•°
  clip_eps: 0.2                  # è£å‰ªå‚æ•°
  gamma: 0.99                    # æŠ˜æ‰£å› å­
  lam: 0.95                      # GAE Î»å‚æ•°

  # æ­£åˆ™åŒ–
  entropy_coef: 0.01             # ç†µç³»æ•°
  value_coef: 0.5                # ä»·å€¼å‡½æ•°ç³»æ•°

  # æ¢¯åº¦å¤„ç†
  max_grad_norm: 0.5             # æ¢¯åº¦è£å‰ªé˜ˆå€¼

# è®­ç»ƒé…ç½®
train:
  rollout_length: 512           # å›åˆé•¿åº¦
  batch_size: 32                 # æ‰¹æ¬¡å¤§å°
  num_updates: 10                # æ¯æ¬¡æ”¶é›†åæ›´æ–°æ¬¡æ•°
  num_episodes: 10000            # æ€»è®­ç»ƒå›åˆæ•°

  # ä¿å­˜å’Œæ—¥å¿—
  save_interval: 100             # ä¿å­˜é—´éš”
  log_interval: 10               # æ—¥å¿—é—´éš”

# å¥–åŠ±å‡½æ•°é…ç½®ï¼ˆåŸºäºåŸå§‹MuJoCoè®ºæ–‡è®¾è®¡ï¼‰
reward:
  # ğŸ¯ ç²¾åº¦å¥–åŠ± r_a^t = -w_a * exp(Ïƒ * f_a(Î¸^t))
  accuracy:
    weight: 5.0                  # ç²¾åº¦æƒé‡
    threshold: 0.005             # æˆåŠŸé˜ˆå€¼ï¼ˆç±³ï¼‰
    sigma: 0.5                   # æŒ‡æ•°æƒ©ç½šå‚æ•°ï¼ˆæ§åˆ¶æƒ©ç½šé™¡å³­ç¨‹åº¦ï¼‰

  # ğŸ”§ æ§åˆ¶ç¨³å®šæ€§å¥–åŠ±ï¼ˆPIDå‚æ•°å˜åŒ–å¹…åº¦æ§åˆ¶ï¼‰
  stability:
    weight: 0.5                  # ç¨³å®šæ€§æƒé‡
    max_change: 0.5              # æœ€å¤§å‚æ•°å˜åŒ–å¹…åº¦

  # ğŸƒ å“åº”é€Ÿåº¦å¥–åŠ±ï¼ˆå¥–åŠ±è¯¯å·®å‡å°‘é€Ÿåº¦ï¼‰
  speed:
    weight: 1.0                  # é€Ÿåº¦æƒé‡

  # ğŸŠ ç¨€ç–æˆåŠŸå¥–åŠ±ï¼ˆåˆ°è¾¾ç›®æ ‡æ—¶çš„é¢å¤–å¥–åŠ±ï¼‰
  extra:
    success_reward: 10.0         # æˆåŠŸåˆ°è¾¾ç›®æ ‡ä½ç½®çš„å¥–åŠ±

  # ğŸ“ å·²ç§»é™¤ï¼šèƒ½è€—æ•ˆç‡å¥–åŠ±ï¼ˆä¸“æ³¨äºä½ç½®æ§åˆ¶æ€§èƒ½ï¼‰
  # energy:
  #   weight: 0.001                # èƒ½è€—æƒé‡

# UR10eå®˜æ–¹PIDå‚æ•°é…ç½®ï¼ˆåŸºäºisaac_gym_manipulatorå®˜æ–¹é…ç½®ï¼‰
# å‚è€ƒ: /isaac_gym_manipulator/ros_sources/universal_robot/ur_gazebo/config/ur10e_controllers.yaml
pid_params:
  # åŸºç¡€PIDå‚æ•°ï¼ˆå®˜æ–¹æ¨èå€¼ï¼‰
  base_gains:
    # æ¯”ä¾‹å¢ç›Š P: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    p: [20000.0, 20000.0, 10000.0, 500.0, 500.0, 10.0]
    # å¾®åˆ†å¢ç›Š D: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    d: [100.0, 100.0, 100.0, 1.0, 1.0, 0.1]
    # ç§¯åˆ†å¢ç›Š I: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    i: [10.0, 20.0, 10.0, 1.0, 1.0, 0.0]

  # åŠ›çŸ©é™åˆ¶ï¼ˆæ¥è‡ªå®˜ï¿½ï¿½URDFï¼‰
  torque_limits: [330.0, 330.0, 150.0, 54.0, 54.0, 54.0]  # Nâ‹…m

# ç½‘ç»œæ¶æ„é…ç½®
network:
  # Actorç½‘ç»œ
  actor:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

  # Criticç½‘ç»œ
  critic:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

# ä»·å€¼å½’ä¸€åŒ–é…ç½®
value_normalization:
  enabled: true                  # å¯ç”¨ä»·å€¼å½’ä¸€åŒ–
  beta: 0.995                    # EMAç³»æ•°
  epsilon: 1e-5                  # æ•°å€¼ç¨³å®šæ€§å‚æ•°
  clip_range: 10.0               # å½’ä¸€åŒ–è£å‰ªèŒƒå›´

# å¥–åŠ±å½’ä¸€åŒ–é…ç½®
reward_normalization:
  enabled: true                  # å¯ç”¨å¥–åŠ±å½’ä¸€åŒ–
  gamma: 0.99                    # æŠ˜æ‰£å› å­
  clip_range: 5.0                # å½’ä¸€åŒ–å€¼è£å‰ªèŒƒå›´
  warmup_steps: 100              # çƒ­èº«æ­¥æ•°
  normalize_method: 'running_stats'  # å½’ä¸€åŒ–æ–¹æ³•
  per_env: true                  # æ¯ä¸ªç¯å¢ƒç‹¬ç«‹å½’ä¸€åŒ–

# è°ƒè¯•å’Œç›‘æ§
debug:
  log_level: "INFO"              # æ—¥å¿—çº§åˆ«
  monitor_frequency: 10          # ç›‘æ§é¢‘ç‡
  save_visualization: false      # ä¿å­˜å¯è§†åŒ–æ•°æ®