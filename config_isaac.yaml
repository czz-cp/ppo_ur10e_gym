# Isaac Gym PPOé…ç½®æ–‡ä»¶
# UR10e RL-PIDæ··åˆæ§åˆ¶ - Isaac Gymç‰ˆæœ¬ï¼ˆæ¸…ç†é‡å¤å‚æ•°ï¼‰

# ç¯å¢ƒé…ç½®
env:
  num_envs: 2                    # å¹¶è¡Œç¯å¢ƒæ•°é‡
  max_steps: 500                 # å¢åŠ æœ€å¤§æ­¥æ•°ï¼Œç»™è¶³å¤Ÿæ—¶é—´åˆ°è¾¾ç›®æ ‡
  device_id: 2                   # GPUè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  dt: 0.01                       # 100Hzï¼Œä¸MuJoCoåŸå§‹é…ç½®ä¸€è‡´

  # ğŸ¯ ç›®æ ‡ä½ç½®èŒƒå›´ (UR10eèˆ’é€‚å·¥ä½œåŒº)
  # ç¼©å°èŒƒå›´ç¡®ä¿ç›®æ ‡å¯è¾¾ï¼Œé¿å…è¿‡äºå›°éš¾çš„è¿œè·ç¦»ç›®æ ‡
  target_range:
    x: [-0.6, 0.6]               # Xè½´èŒƒå›´ (ç¼©å°åˆ°èˆ’é€‚å·¥ä½œåŒº)
    y: [-0.6, 0.6]               # Yè½´èŒƒå›´ (ç¼©å°åˆ°èˆ’é€‚å·¥ä½œåŒº)
    z: [0.1, 0.8]                # Zè½´èŒƒå›´ (é¿å…è¿‡é«˜æˆ–è¿‡ä½çš„ç›®æ ‡)

# ğŸ¯ è®¾å¤‡é…ç½®ï¼ˆå‚è€ƒisaac_gym_manipulatoræ–¹æ¡ˆï¼‰
device: "cuda:2"                 # PyTorchè®¾å¤‡ (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
sim:
  device_id: 2                  # Isaac Gymä»¿çœŸè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  # ç‰©ç†å¼•æ“é…ç½®ï¼ˆåŸºäºisaac_gym_manipulatoræˆåŠŸé…ç½®ï¼‰
  solver_type: 1                 # ä½¿ç”¨solver_type=1
  num_position_iterations: 4     # ä½ç½®è¿­ä»£æ¬¡æ•°
  num_velocity_iterations: 1     # é€Ÿåº¦è¿­ä»£æ¬¡æ•°
  num_threads: 0                 # çº¿ç¨‹æ•°ï¼ˆ0=è‡ªåŠ¨ï¼‰
  use_gpu: true                  # å¯ç”¨GPU
  use_gpu_pipeline: false        # ç¦ç”¨GPUæ¸²æŸ“ç®¡çº¿

  # æ—¶é—´æ­¥é•¿é…ç½®
  substeps: 2                    # ä½¿ç”¨2ä¸ªå­æ­¥éª¤ï¼Œæé«˜ä»¿çœŸç¨³å®šæ€§

graphics:
  graphics_device_id: 2          # å›¾å½¢è®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)

visualization:
  enable: false                   # å¯ç”¨å¯è§†åŒ–ï¼ˆå‚è€ƒisaac_gym_manipulatorï¼‰
  render_freq: 1                 # æ¸²æŸ“é¢‘ç‡

# PPOç®—æ³•é…ç½®ï¼ˆä¼˜åŒ–è¶…å‚æ•°ï¼‰
ppo:
  # å­¦ä¹ ç‡ï¼ˆé™ä½ä»¥ç¨³å®šè®­ç»ƒï¼‰
  lr_actor: 1e-4                 # é™ä½Actorå­¦ä¹ ç‡ï¼Œæ›´ç¨³å®šå­¦ä¹ 
  lr_critic: 5e-4                # é™ä½Criticå­¦ä¹ ç‡

  # PPOæ ¸å¿ƒå‚æ•°ï¼ˆä¿å®ˆè®¾ç½®ï¼‰
  clip_eps: 0.15                 # é™ä½è£å‰ªå‚æ•°ï¼Œæ›´ä¿å®ˆæ›´æ–°
  gamma: 0.995                   # ç•¥å¾®æé«˜æŠ˜æ‰£å› å­ï¼Œæ›´é‡è§†é•¿æœŸå¥–åŠ±
  lam: 0.95                      # GAE Î»å‚æ•°ä¿æŒä¸å˜

  # æ­£åˆ™åŒ–ï¼ˆå¢åŠ æ¢ç´¢ï¼‰
  entropy_coef: 0.02             # å¢åŠ ç†µç³»æ•°ï¼Œé¼“åŠ±æ›´å¤šæ¢ç´¢
  value_coef: 0.5                # ä»·å€¼å‡½æ•°ç³»æ•°ä¿æŒä¸å˜

  # æ¢¯åº¦å¤„ç†
  max_grad_norm: 0.5             # æ¢¯åº¦è£å‰ªé˜ˆå€¼ä¿æŒä¸å˜

# è®­ï¿½ï¿½ï¿½é…ç½®ï¼ˆä¼˜åŒ–rolloutç­–ç•¥ï¼‰
train:
  rollout_length: 256           # é™ä½rollouté•¿åº¦ï¼Œæ›´é€‚åˆ500æ­¥episode
  batch_size: 32                 # æ‰¹æ¬¡å¤§å°
  num_updates: 10                # æ¯æ¬¡æ”¶é›†åæ›´æ–°æ¬¡æ•°
  num_episodes: 10000            # æ€»è®­ç»ƒå›åˆæ•°

  # ä¿å­˜å’Œæ—¥å¿—
  save_interval: 100             # ä¿å­˜é—´éš”
  log_interval: 10               # æ—¥å¿—é—´éš”

# ğŸ¯ é‡æ–°è®¾è®¡çš„å¥–åŠ±å‡½æ•°é…ç½®ï¼ˆå­¦ä¹ å‹å¥½å‹ï¼‰
reward:
  # ğŸ¯ è·ç¦»å¥–åŠ±ï¼ˆæ¸©å’Œçš„çº¿æ€§æƒ©ç½šï¼‰
  accuracy:
    weight: 2.0                  # é™ä½ç²¾åº¦æƒé‡ï¼Œé¿å…è¿‡åº¦æƒ©ç½š
    threshold: 0.005             # æ”¾å®½æˆåŠŸé˜ˆå€¼åˆ°5å˜ç±³ï¼ˆæ›´ç°å®ï¼‰

  # ğŸƒ è¿›åº¦å¥–åŠ±ï¼ˆå¥–åŠ±å‘ç›®æ ‡ç§»åŠ¨çš„è¡Œä¸ºï¼‰
  progress:
    weight: 3.0                  # å¢åŠ è¿›åº¦å¥–åŠ±æƒé‡ï¼Œé¼“åŠ±ä¸»åŠ¨æ¥è¿‘

  # ğŸ”§ ç¨³å®šæ€§å¥–åŠ±ï¼ˆPIDå‚æ•°åˆç†æ€§çº¦æŸï¼‰
  stability:
    weight: 0.3                  # é™ä½ç¨³å®šæ€§æƒé‡ï¼Œå…è®¸æ›´å¤šæ¢ç´¢

  # ğŸŠ æˆåŠŸå¥–åŠ±ï¼ˆæ˜ç¡®çš„ç›®æ ‡åˆ°è¾¾ä¿¡å·ï¼‰
  extra:
    success_reward: 5.0          # é™ä½æˆåŠŸå¥–åŠ±ï¼Œé¿å…è¿‡åº¦ä¾èµ–ç¨€ç–å¥–åŠ±

  # ğŸ“ å·²ç§»é™¤ï¼šèƒ½è€—æ•ˆç‡å¥–åŠ±ï¼ˆä¸“æ³¨äºä½ç½®æ§åˆ¶æ€§èƒ½ï¼‰
  # energy:
  #   weight: 0.001                # èƒ½è€—æƒé‡

# UR10eå®˜æ–¹PIDå‚æ•°é…ç½®ï¼ˆåŸºäºisaac_gym_manipulatorå®˜æ–¹é…ç½®ï¼‰
# å‚è€ƒ: /isaac_gym_manipulator/ros_sources/universal_robot/ur_gazebo/config/ur10e_controllers.yaml
pid_params:
  # åŸºç¡€PIDå‚æ•°ï¼ˆå®˜æ–¹æ¨èå€¼ï¼‰
  base_gains:
    # æ¯”ä¾‹å¢ç›Š P: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    p: [20000.0, 20000.0, 10000.0, 500.0, 500.0, 10.0]
    # å¾®åˆ†å¢ç›Š D: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    d: [100.0, 100.0, 100.0, 1.0, 1.0, 0.1]
    # ç§¯åˆ†å¢ç›Š I: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    i: [10.0, 20.0, 10.0, 1.0, 1.0, 0.0]

  # åŠ›çŸ©é™åˆ¶ï¼ˆæ¥è‡ªå®˜ï¿½ï¿½URDFï¼‰
  torque_limits: [330.0, 330.0, 150.0, 54.0, 54.0, 54.0]  # Nâ‹…m

# ç½‘ç»œæ¶æ„é…ç½®
network:
  # Actorç½‘ç»œ
  actor:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

  # Criticç½‘ç»œ
  critic:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

# ä»·å€¼å½’ä¸€åŒ–é…ç½®
value_normalization:
  enabled: true                  # å¯ç”¨ä»·å€¼å½’ä¸€åŒ–
  beta: 0.995                    # EMAç³»æ•°
  epsilon: 1e-5                  # æ•°å€¼ç¨³å®šæ€§å‚æ•°
  clip_range: 10.0               # å½’ä¸€åŒ–è£å‰ªèŒƒå›´

# å¥–åŠ±å½’ä¸€åŒ–é…ç½®
reward_normalization:
  enabled: true                  # å¯ç”¨å¥–åŠ±å½’ä¸€åŒ–
  gamma: 0.99                    # æŠ˜æ‰£å› å­
  clip_range: 5.0                # å½’ä¸€åŒ–å€¼è£å‰ªèŒƒå›´
  warmup_steps: 100              # çƒ­èº«æ­¥æ•°
  normalize_method: 'running_stats'  # å½’ä¸€åŒ–æ–¹æ³•
  per_env: true                  # æ¯ä¸ªç¯å¢ƒç‹¬ç«‹å½’ä¸€åŒ–

# è°ƒè¯•å’Œç›‘æ§
debug:
  log_level: "INFO"              # æ—¥å¿—çº§åˆ«
  monitor_frequency: 10          # ç›‘æ§é¢‘ç‡
  save_visualization: false      # ä¿å­˜å¯è§†åŒ–æ•°æ®