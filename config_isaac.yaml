# Isaac Gym PPOé…ç½®æ–‡ä»¶
# UR10e RL-PIDæ··åˆæ§åˆ¶ - Isaac Gymç‰ˆæœ¬ï¼ˆæ¸…ç†é‡å¤å‚æ•°ï¼‰

# ç¯å¢ƒé…ç½®
env:
  num_envs: 2                    # å¹¶è¡Œç¯å¢ƒæ•°é‡
  max_steps: 512                 # å¢åŠ æœ€å¤§æ­¥æ•°ï¼Œç»™è¶³å¤Ÿæ—¶é—´åˆ°è¾¾ç›®æ ‡
  device_id: 0                   # GPUè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  dt: 0.01                       # 100Hzï¼Œä¸MuJoCoåŸå§‹é…ç½®ä¸€è‡´

  # ğŸ¯ ç›®æ ‡ä½ç½®èŒƒå›´ (UR10eèˆ’é€‚å·¥ä½œåŒº)
  # ç¼©å°èŒƒå›´ç¡®ä¿ç›®æ ‡å¯è¾¾ï¼Œé¿å…è¿‡äºå›°éš¾çš„è¿œè·ç¦»ç›®æ ‡
  target_range:
    x: [-0.6, 0.6]               # Xè½´èŒƒå›´ (ç¼©å°åˆ°èˆ’é€‚å·¥ä½œåŒº)
    y: [-0.6, 0.6]               # Yè½´èŒƒå›´ (ç¼©å°åˆ°èˆ’é€‚å·¥ä½œåŒº)
    z: [0.1, 0.8]                # Zè½´èŒƒå›´ (é¿å…è¿‡é«˜æˆ–è¿‡ä½çš„ç›®æ ‡)

# ğŸ¯ è®¾å¤‡é…ç½®ï¼ˆå‚è€ƒisaac_gym_manipulatoræ–¹æ¡ˆï¼‰
device: "cuda:0"                 # PyTorchè®¾å¤‡ (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
sim:
  device_id: 0                  # Isaac Gymä»¿çœŸè®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)
  # ç‰©ç†å¼•æ“é…ç½®ï¼ˆåŸºäºisaac_gym_manipulatoræˆåŠŸé…ç½®ï¼‰
  solver_type: 1                 # ä½¿ç”¨solver_type=1
  num_position_iterations: 4     # ä½ç½®è¿­ä»£æ¬¡æ•°
  num_velocity_iterations: 1     # é€Ÿåº¦è¿­ä»£æ¬¡æ•°
  num_threads: 0                 # çº¿ç¨‹æ•°ï¼ˆ0=è‡ªåŠ¨ï¼‰
  use_gpu: true                  # å¯ç”¨GPU
  use_gpu_pipeline: false        # ç¦ç”¨GPUæ¸²æŸ“ç®¡çº¿

  # æ—¶é—´æ­¥é•¿é…ç½®
  substeps: 2                    # ä½¿ç”¨2ä¸ªå­æ­¥éª¤ï¼Œæé«˜ä»¿çœŸç¨³å®šæ€§

graphics:
  graphics_device_id: 2          # å›¾å½¢è®¾å¤‡ID (ç”¨æˆ·æœåŠ¡å™¨ä½¿ç”¨GPU 2)

visualization:
  enable: false                   # å¯ç”¨å¯è§†åŒ–ï¼ˆå‚è€ƒisaac_gym_manipulatorï¼‰
  render_freq: 1                 # æ¸²æŸ“é¢‘ç‡

# PPOç®—æ³•é…ç½®ï¼ˆä¼˜åŒ–è¶…å‚æ•°ï¼‰
ppo:
  # å­¦ä¹ ç‡ï¼ˆé™ä½ä»¥ç¨³å®šè®­ç»ƒï¼‰
  lr_actor: 1e-4                 # é™ä½Actorå­¦ä¹ ç‡ï¼Œæ›´ç¨³å®šå­¦ä¹ 
  lr_critic: 5e-4                # é™ä½Criticå­¦ä¹ ç‡

  # PPOæ ¸å¿ƒå‚æ•°ï¼ˆä¿å®ˆè®¾ç½®ï¼‰
  clip_eps: 0.15                 # é™ä½è£å‰ªå‚æ•°ï¼Œæ›´ä¿å®ˆæ›´æ–°
  gamma: 0.995                   # ç•¥å¾®æé«˜æŠ˜æ‰£å› å­ï¼Œæ›´é‡è§†é•¿æœŸå¥–åŠ±
  lam: 0.95                      # GAE Î»å‚æ•°ä¿æŒä¸å˜

  # æ­£åˆ™åŒ–ï¼ˆå¢åŠ æ¢ç´¢ï¼‰
  entropy_coef: 0.02             # å¢åŠ ç†µç³»æ•°ï¼Œé¼“åŠ±æ›´å¤šæ¢ç´¢
  value_coef: 0.5                # ä»·å€¼å‡½æ•°ç³»æ•°ä¿æŒä¸å˜

  # æ¢¯åº¦å¤„ç†
  max_grad_norm: 0.5             # æ¢¯åº¦è£å‰ªé˜ˆå€¼ä¿æŒä¸å˜

# è®­ï¿½ï¿½ï¿½é…ç½®ï¼ˆä¼˜åŒ–rolloutç­–ç•¥ï¼‰
train:
  rollout_length: 512           # é™ä½rollouté•¿åº¦ï¼Œæ›´é€‚åˆ500æ­¥episode
  batch_size: 32                 # æ‰¹æ¬¡å¤§å°
  num_updates: 10                # æ¯æ¬¡æ”¶é›†åæ›´æ–°æ¬¡æ•°
  num_episodes: 10000            # æ€»è®­ç»ƒå›åˆæ•°

  # ä¿å­˜å’Œæ—¥å¿—
  save_interval: 100             # ä¿å­˜é—´éš”
  log_interval: 10               # æ—¥å¿—é—´éš”

# ğŸ¯ æ–°çš„å¥–åŠ±å‡½æ•°é…ç½®ï¼ˆåŸºäºå…³èŠ‚è§’åº¦è¯¯å·®ï¼‰
reward:
  # ğŸ¯ å…³èŠ‚è§’åº¦è¯¯å·®å¥–åŠ±ï¼ˆä¸»è¦å¥–åŠ±ï¼‰
  accuracy:
    weight: 2.0                  # å…³èŠ‚è§’åº¦è¯¯å·®æƒé‡
    threshold: 0.05              # æœ«ç«¯ä½ç½®æˆåŠŸé˜ˆå€¼ï¼ˆæ¬¡è¦ï¼‰

  # ğŸƒ å…³èŠ‚è¿›åº¦å¥–åŠ±ï¼ˆå¥–åŠ±è¯¯å·®å‡å°‘ï¼‰
  progress:
    weight: 1.0                  # å…³èŠ‚è§’åº¦è¯¯å·®å‡å°‘æƒé‡

  # ğŸ“ æœ«ç«¯ä½ç½®è¯¯å·®å¥–åŠ±ï¼ˆæ¬¡è¦å¥–åŠ±ï¼‰
  position:
    weight: 0.5                  # æœ«ç«¯ä½ç½®è¯¯å·®æƒé‡

  # ğŸ”§ PIDå‚æ•°ç¨³å®šæ€§å¥–åŠ±
  stability:
    weight: 0.1                  # PIDå‚æ•°åˆç†æ€§çº¦æŸæƒé‡

  # ğŸŠ æˆåŠŸå¥–åŠ±
  extra:
    success_reward: 5.0          # å…³èŠ‚åˆ°è¾¾æˆåŠŸå¥–åŠ±
    position_success_reward: 2.0  # æœ«ç«¯ä½ç½®æˆåŠŸå¥–åŠ±

# UR10e PIDå‚æ•°é…ç½®ï¼ˆåŸºäºDDPGæˆåŠŸæ¡ˆä¾‹è°ƒä¼˜ï¼‰
# å‚è€ƒDDPGä¸­çš„æ¸©å’Œå‚æ•°ï¼Œé¿å…è¿‡å¤§çš„å¢ç›Šå¯¼è‡´éœ‡è¡
pid_params:
  # åŸºç¡€PIDå‚æ•°ï¼ˆè°ƒä¼˜åçš„æ¸©å’Œå€¼ï¼‰
  base_gains:
    # æ¯”ä¾‹å¢ç›Š P: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    p: [1500.0, 1500.0, 800.0, 300.0, 300.0, 100.0]  # DDPGæˆåŠŸæ¡ˆä¾‹çš„å€¼
    # å¾®åˆ†å¢ç›Š D: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    d: [180.0, 180.0, 110.0, 50.0, 50.0, 50.0]        # ç»Ÿä¸€çš„é˜»å°¼ç³»æ•°
    # ç§¯åˆ†å¢ç›Š I: [shoulder_pan, shoulder_lift, elbow, wrist_1, wrist_2, wrist_3]
    i: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]                   # æš‚æ—¶ä¸ç”¨ç§¯åˆ†é¡¹

  # åŠ›çŸ©é™åˆ¶ï¼ˆä¿å®ˆå€¼ï¼Œç¡®ä¿å®‰å…¨ï¼‰
  torque_limits: [264.0, 264.0, 120.0, 43.2, 43.2, 43.2]  # 80% ofå®˜æ–¹é™åˆ¶

# ç½‘ç»œæ¶æ„é…ç½®
network:
  # Actorç½‘ç»œ
  actor:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

  # Criticç½‘ç»œ
  critic:
    hidden_dim: 64               # éšè—å±‚ç»´åº¦
    num_layers: 3                # ç½‘ç»œå±‚æ•°
    activation: "relu"           # æ¿€æ´»å‡½æ•°

# ä»·å€¼å½’ä¸€åŒ–é…ç½®
value_normalization:
  enabled: true                  # å¯ç”¨ä»·å€¼å½’ä¸€åŒ–
  beta: 0.995                    # EMAç³»æ•°
  epsilon: 1e-5                  # æ•°å€¼ç¨³å®šæ€§å‚æ•°
  clip_range: 10.0               # å½’ä¸€åŒ–è£å‰ªèŒƒå›´

# å¥–åŠ±å½’ä¸€åŒ–é…ç½®
reward_normalization:
  enabled: true                  # å¯ç”¨å¥–åŠ±å½’ä¸€åŒ–
  gamma: 0.99                    # æŠ˜æ‰£å› å­
  clip_range: 5.0                # å½’ä¸€åŒ–å€¼è£å‰ªèŒƒå›´
  warmup_steps: 100              # çƒ­èº«æ­¥æ•°
  normalize_method: 'running_stats'  # å½’ä¸€åŒ–æ–¹æ³•
  per_env: true                  # æ¯ä¸ªç¯å¢ƒç‹¬ç«‹å½’ä¸€åŒ–

# è°ƒè¯•å’Œç›‘æ§
debug:
  log_level: "INFO"              # æ—¥å¿—çº§åˆ«
  monitor_frequency: 10          # ç›‘æ§é¢‘ç‡
  save_visualization: false      # ä¿å­˜å¯è§†åŒ–æ•°æ®